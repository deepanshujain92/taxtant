doctype html
html
  head
    script(src='http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js')
    link(rel='stylesheet', href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css')
    script(type='text/javascript').
      var lan = "en-US";
      var accessToken = "186574d18dd04bab89242721d5fdc063";
      var baseUrl = "https://api.api.ai/v1/";
      $(document).ready(function() {
      $("#input").keypress(function(event) {
      if (event.which === 13) {
      event.preventDefault();
      send();
      }
      });
      $("#rec").click(function(event) {
      switchRecognition();
      });
       $("#hindi").click(function(event) {
      lan = "hi-IN";
      document.getElementById("input").value='';
      });
      $("#english").click(function(event) {
      lan = "en-US";
      document.getElementById("input").value='';

      });
      });
      var recognition;
      function startRecognition() {
      recognition = new webkitSpeechRecognition();
      recognition.onstart = function(event) {
      updateRec();
      };
      recognition.onresult = function(event) {
      var text = "";
      for (var i = event.resultIndex; i < event.results.length; ++i) {
      text += event.results[i][0].transcript;
      }
      setInput(text);
      stopRecognition();
      };
      recognition.onend = function() {
      stopRecognition();
      };
      recognition.lang = lan;
      recognition.start();
      }
      function stopRecognition() {
      if (recognition) {
      recognition.stop();
      recognition = null;
      }
      updateRec();
      }
      function switchRecognition() {
      if (recognition) {
      stopRecognition();
      } else {
      startRecognition();
      }
      }
      function setInput(text) {
      $("#input").val(text);
      send();
      }
      function updateRec() {
      $("#rec").text(recognition ? "Stop" : "Speak");
      }
      function send() {
      var text = $("#input").val();
      $.ajax({
      type: "POST",
      url: baseUrl + "query?v=20150910",
      contentType: "application/json; charset=utf-8",
      dataType: "json",
      headers: {
      "Authorization": "Bearer " + accessToken
      },
      data: JSON.stringify({ query: text, lang: "en", sessionId: "somerandomthing" }),
      success: function(data) {
      setResponse(data.result.fulfillment.speech);
      },
      error: function() {
      setResponse("Internal Server Error");
      }
      });
      setResponse("Loading...");
      }
      function setResponse(val) {
      $("#response").text(val);
      }
    title Welcome to Taxtant - your personal tax assistant bot 
    meta(name='Taxtant', content='NOINDEX, NOFOLLOW')
    link(rel='stylesheet', href='\\stylesheets\\style.css')
    header
  body
    img(src='\\images\\logo.png', alt='Taxtant: Your Virtual CA')
    // HTML for SEARCH BAR
    #tfheader
      .form-wrapper
        input#input(type='text', placeholder='Search for...', required='')
        button#rec.btn.btn-primary Speak
        .radio
          label
            input#english(type='radio', name='optradio')
            | English
          label
            input#hindi(type='radio', name='optradio')
            | हिंदी
      .tfclear
        br
        | Response
        br
        #response
